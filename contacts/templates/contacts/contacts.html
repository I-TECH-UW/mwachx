{% extends 'base.html' %}
{% load staticfiles %}
{% block title %}Contacts{% endblock %}

{% block content %}
{% include 'add-new-visit.html' %}
    {% if contacts %}
    <table id='contacts-table' class='table table-striped table-hover table-condensed'>
        <thead><tr>
            <th>ID</th>
            <th>ANC #</th>
            <th>Nickname</th>
            <th>Study Group</th>
            <th>Status</th>
            <th>Number</th>
            <th>Weeks</th>
            <th>Sent</th>
            <th>Received</th>
            <th></th>
        </tr></thead>
        <tbody>
    {% for contact in contacts %}
        <tr class='link-row' data-target='/contact/{{contact.study_id}}'>
            <td>{{contact.study_id|stringformat:'03i'}}</td>
            <td>{{contact.anc_num}}</td>
            <td>{{contact.nickname}}</td>
            <td>{{contact.study_group}}</td>
            <td>{{contact.status}}</td>
            <td>{{contact.phone_number}}</td>
            <td>{{contact.weeks}}</td>
            <td>{{contact.messages_sent}}</td>
            <td>{{contact.messages_received}}</td>
            <td><a class="btn btn-primary" data-toggle='modal' data-target='#visitScheduleModal' data-src={% url 'contacts.views.contacts' %} data-study-id={{contact.study_id}}>Visited</a></td>
        </tr>
        </a>
    {% endfor %}
    </tbody>
    {% endif %}
    
<script language='javascript'>
    $(function(){
       $('.link-row').click(
            function(e) {
                // Only propogate if it is not a button
                if(! $(e.target).hasClass('btn') ) {
                    window.location=$(this).data('target');
                }
            }); 
    });
</script>

<script src='{% static "js/visit_modal.js" %}'></script>
    
{% endblock %}
